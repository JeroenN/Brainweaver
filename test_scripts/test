 #!/bin/bash

# From the documentation:
# For example, to include line numbers for a assertEquals() 
# function call, replace the assertEquals() with ${_ASSERT_EQUALS_}.


# Prerequisite scripts
cd ../../testing_cpp_gui_applications_tutorial/scripts
. ./get_dialog_id_by_title
. ./close_first_dialog_by_title

# Go back
cd ../../Brainweaver/test_scripts

# Brainweaver scripts
. ./start_brainweaver

test_start_brainweaver()
{
  # Should first be absent
  id=`get_dialog_id_by_title 'Menu voor de ontwikkelaar'`

  #${_ASSERT_NULL_} "$id"
  if [ $id ]; then
    fail "Absent dialog must not have an ID"
  fi

  # Create dialog
  start_brainweaver
  sleep 1
  id=`get_dialog_id_by_title 'Menu voor de ontwikkelaar'`
  ${_ASSERT_NOT_NULL_} "$id"

  # Close dialog
  xdotool windowactivate $id sleep 0.2 key Escape sleep 1.0
  # Cannot use the line below, as Brainweaver closes with Escape only
  #close_first_dialog_by_title 'Menu voor de ontwikkelaar'

  # Should be absent again
  id=`get_dialog_id_by_title 'Menu voor de ontwikkelaar'`
  #${_ASSERT_NULL_} "$id"
  if [ $id ]; then
    fail "Closed dialog must not have an ID"
  fi
}

# load shunit2
. ../../shunit2/source/2.1/src/shunit2